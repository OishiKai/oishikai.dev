---
import BaseLayout from '@/layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const products = (await getCollection('products'))
  .sort((a, b) => a.data.order - b.data.order);
---

<BaseLayout title="Products" description="リリースしているアプリの紹介">
  <div class="mx-auto max-w-4xl px-4 py-12">
    <h1 class="text-3xl font-bold text-gray-900 dark:text-white sm:text-4xl">Products</h1>
    <p class="mt-2 text-gray-600 dark:text-gray-400">リリースしているアプリの紹介です。</p>

    <div class="mt-8 grid gap-6 sm:grid-cols-2">
      {products.map((product) => (
        <a
          href={`/products/${product.id}`}
          class="group rounded-xl border border-gray-200 bg-white p-6 transition-shadow hover:shadow-md dark:border-gray-700 dark:bg-surface-dark-secondary"
        >
          <div class="flex items-start gap-4">
            <div class={`flex h-14 w-14 shrink-0 items-center justify-center rounded-xl bg-gradient-to-br ${product.data.iconGradient} text-lg font-bold text-white shadow`}>
              {product.data.iconLabel}
            </div>
            <div class="min-w-0 flex-1">
              <h2 class="text-lg font-semibold text-gray-900 group-hover:text-primary-600 dark:text-white dark:group-hover:text-primary-400 transition-colors">
                {product.data.title}
              </h2>
              <p class="mt-0.5 text-xs text-gray-500 dark:text-gray-400">
                {product.data.platform} &middot; {product.data.price}
                {product.data.rating && <> &middot; {product.data.rating}</>}
              </p>
              <p class="mt-2 text-sm text-gray-600 line-clamp-2 dark:text-gray-400">
                {product.data.description}
              </p>
              <div class="mt-3 flex flex-wrap gap-1.5">
                {product.data.techStack.map((tech: string) => (
                  <span class="rounded-full bg-primary-50 px-2 py-0.5 text-xs font-medium text-primary-700 dark:bg-primary-900/30 dark:text-primary-300">
                    {tech}
                  </span>
                ))}
              </div>
            </div>
          </div>
        </a>
      ))}
    </div>
  </div>
</BaseLayout>
